---
import { Image } from "@astrojs/image/components";
import Layout from "./Layout.astro";
import AddToCartBtn from "../components/AddToCartBtn.jsx";

const { frontmatter, url } = Astro.props;
const {
    product,
    prices,
    available,
    imgs,
    category,
    paperback,
    digital,
    exerpt,
    id
} = frontmatter;
console.log();
---

<Layout title={`Shop ${product}`} description={exerpt}>
    <section class="mt-24 md:mt-36">
        <div
            class="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-5xl mx-auto py-16"
        >
            <div id="prodImage" class="w-[20rem] mx-auto">
                {imgs&&<Image
                    class="w-full h-full rounded-md shadow-xl"
                    src={imgs[0]}
                    width={500}
                    aspectRatio={"3:4"}
                />}
            </div>
            <div id="prodInformation" class="">
                <h1 class="h1 font-extrabold p-0">{product}</h1>
                <p id="price" class="text-2xl mt-8">
                    $<span id="priceBox" class="">{prices.digital}</span>
                </p>
                <div>
                    <span class="font-medium text-xl">Format:</span><input
                        type="radio"
                        name="format"
                        value="digital"
                        hidden
                        checked
                        id="digital"
                    />
                    <label for="digital" class="size-radio-btn check"
                        >Digital</label
                    >
                    <input
                        type="radio"
                        name="format"
                        value="paperback"
                        hidden
                        id="paperback"
                    />
                    <label for="paperback" class="size-radio-btn"
                        >Paperback</label
                    >
                </div>
                <div class="mt-8">
                    <!-- <span class="font-medium text-xl">Qty:</span>
                    <input
                        type="number"
                        class="bg-neutral-300 border-2 border-neutral-500 pl-2 py-1 w-10"
                    /> -->
                    <AddToCartBtn client:load id={id}/>
                    
                </div>
                <slot />
            </div>
        </div>
    </section>
</Layout>
<style is:global>
    #prodInformation label {
        @apply border-2 border-neutral-500 transition duration-200 px-3 py-2 font-medium bg-neutral-200 cursor-pointer;
    }
    #prodInformation input:checked + label {
        @apply border-orange-500  duration-200 bg-neutral-300;
    }
    #prodInformation p {
        @apply px-0;
    }
</style>
<script define:vars={{prices}}>
    
    const formatInputs=document.querySelectorAll("input[name='format']");
    const priceBox = document.querySelector("#priceBox"); 
    let format = "digital";
    
    updateFormat();

    formatInputs.forEach((input)=>{
        input.addEventListener('change', updateFormat);
    } )




    function updateFormat() {
        let format = document.querySelector(
            "input[name='format']:checked"
        ).value;
        
        priceBox.innerHTML=prices[format];

    }
</script>

